/* #define MAKE_QUESTION */

#include <stdio.h>
#include <sys/types.h>

unsigned char randval[] = {
  0x1D, 0xAB, 0x1B, 0x0F, 0xA7, 0xD9, 0x1A, 0xB0,
  0x61, 0x7E, 0xB6, 0x48, 0xA4, 0x56, 0xCF, 0x7E,
  0x49, 0x05, 0xFD, 0x05, 0x9C, 0xF9, 0x54, 0x45,
  0xFA, 0x24, 0xC6, 0x1D, 0x68, 0xF2, 0x46, 0xCE,
  0xC1, 0xAD, 0xAB, 0x08, 0x24, 0x86, 0x9C, 0xF8,
  0x58, 0x65, 0x62, 0x88, 0x49, 0x22, 0x82, 0x11,
  0x29, 0x14, 0x63, 0x74, 0xAE, 0x28, 0xCE, 0x8C,
  0x79, 0x2D, 0xAB, 0x07, 0xBB, 0x75, 0x25, 0x9D,
};

#ifdef MAKE_QUESTION
unsigned char flag[] = "SECCON{UseTheSpecialDeviceFile}";
#else
unsigned char flag[] = {
  0xFE, 0x75, 0x88, 0xA9, 0x5A, 0xAA, 0x10, 0x52,
  0x9C, 0x6A, 0x67, 0xF4, 0x82, 0xBE, 0x21, 0x56,
  0x59, 0x0B, 0x97, 0x32, 0x21, 0x46, 0x93, 0xAE,
  0x40, 0x0D, 0x2E, 0x1F, 0x83, 0x43, 0x40, 0
};
#endif
 
void random_init(uint64_t seed);
uint64_t get_random_value(void);

static uint64_t random_value = 88172645463325252ULL;

void random_init(uint64_t seed)
{
  random_value = seed;
}

uint64_t get_random_value(void)
{
  /* xorshift (64bit) */
  random_value = random_value ^ (random_value << 13);
  random_value = random_value ^ (random_value >>  7);
  random_value = random_value ^ (random_value << 17);
  return random_value;
}

unsigned char *decode(unsigned char *str, unsigned char *key)
{
  int i;
  for (i = 0; str[i]; i++) {
    str[i] ^= (key[i] ^ get_random_value());
  }
  return str;
}

int main()
{
  random_init(88172645463325252ULL);
  printf("%s\n", decode(flag, randval));
  return 0;
}
